import{Q as E}from"./QBtn-BYTjLwlH.js";import{ax as B,r,w as I,J as c,G as u,N as d,ag as p,K as o,H as z,a1 as C,ae as g}from"./main-DDcL3aaV.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R=["src"],U=["disabled"],F={__name:"Avatar",props:["path","size"],emits:["upload","update:path"],setup(y,{emit:_}){const w=y,{path:n,size:t}=B(w),m=_,l=r(!1),i=r(""),s=r(),v=r(null),b=async()=>{console.log("Download avatar...");try{const{data:e,error:a}=await g.storage.from("avatars").download(n.value);if(a)throw a;i.value=URL.createObjectURL(e)}catch(e){console.error("Error downloading image: ",e.message)}},k=()=>{v.value.click()},A=async e=>{s.value=e.target.files;try{if(l.value=!0,!s.value||s.value.length===0)throw new Error("You must select an image to upload.");const a=s.value[0],x=a.name.split(".").pop(),f=`${Math.random()}.${x}`;let{error:h}=await g.storage.from("avatars").upload(f,a);if(h)throw h;m("update:path",f),m("upload")}catch(a){alert(a.message)}finally{l.value=!1}};return I(n,()=>{n.value&&b()}),(e,a)=>(c(),u(C,null,[d("div",null,[i.value?(c(),u("img",{key:0,src:i.value,alt:"Avatar",class:"circle avatar image",style:p({height:o(t)+"em",width:o(t)+"em"})},null,12,R)):(c(),u("div",{key:1,class:"avatar no-image",style:p({height:o(t)+"em",width:o(t)+"em"})},null,4))]),d("div",{style:p({width:o(t)+"em"})},[z(E,{flat:"",rounded:"",color:"primary",class:"upload-button q-mt-sm",disabled:l.value,icon:"upload",label:l.value?"Uploading ...":"Change Avatar",onClick:k},null,8,["disabled","label"]),d("input",{style:{visibility:"hidden",position:"absolute"},type:"file",id:"single",accept:"image/*",ref_key:"fileInput",ref:v,onChange:A,disabled:l.value},null,40,U)],4)],64))}},$=N(F,[["__scopeId","data-v-2a592a1f"]]);export{$ as A};
