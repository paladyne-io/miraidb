import{r as T,W as _e,g as G,i as se,b as z,a as ce,o as ae,c as x,n as Y,d as Me,e as Ee,h as M,T as Se,U as R}from"./main-DmtuxYzQ.js";import{M as ye,s as qe,r as ee,Q as de,L as Re,d as te,a as Fe,c as we,t as fe}from"./QBtn-Dibum-F4.js";import{h as Ve,b as Ae,c as Pe,a as Be,d as Ie,f as $e,j as Te,e as X,l as Oe,p as Ue}from"./private.use-form-DW6Q8NzA.js";const ge=/^on[A-Z]/;function De(){const{attrs:e,vnode:r}=G(),d={listeners:T({}),attributes:T({})};function s(){const m={},g={};for(const h in e)h!=="class"&&h!=="style"&&ge.test(h)===!1&&(m[h]=e[h]);for(const h in r.props)ge.test(h)===!0&&(g[h]=r.props[h]);d.attributes.value=m,d.listeners.value=g}return _e(s),s(),d}function Le({validate:e,resetValidation:r,requiresQForm:d}){const s=se(Ve,!1);if(s!==!1){const{props:m,proxy:g}=G();Object.assign(g,{validate:e,resetValidation:r}),z(()=>m.disable,h=>{h===!0?(typeof r=="function"&&r(),s.unbindComponent(g)):s.bindComponent(g)}),ce(()=>{m.disable!==!0&&s.bindComponent(g)}),ae(()=>{m.disable!==!0&&s.unbindComponent(g)})}else d===!0&&console.error("Parent QForm not found on useFormChild()!")}const me=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,ve=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,he=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,re=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,oe=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,le={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>me.test(e),hexaColor:e=>ve.test(e),hexOrHexaColor:e=>he.test(e),rgbColor:e=>re.test(e),rgbaColor:e=>oe.test(e),rgbOrRgbaColor:e=>re.test(e)||oe.test(e),hexOrRgbColor:e=>me.test(e)||re.test(e),hexaOrRgbaColor:e=>ve.test(e)||oe.test(e),anyColor:e=>he.test(e)||re.test(e)||oe.test(e)};function je(e,r=250,d){let s=null;function m(){const g=arguments,h=()=>{s=null,e.apply(this,g)};s!==null&&clearTimeout(s),s=setTimeout(h,r)}return m.cancel=()=>{s!==null&&clearTimeout(s)},m}const Ne=[!0,!1,"ondemand"],ze={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:e=>Ne.includes(e)}};function Ke(e,r){const{props:d,proxy:s}=G(),m=T(!1),g=T(null),h=T(!1);Le({validate:U,resetValidation:O});let w=0,F;const E=x(()=>d.rules!==void 0&&d.rules!==null&&d.rules.length!==0),C=x(()=>d.disable!==!0&&E.value===!0&&r.value===!1),k=x(()=>d.error===!0||m.value===!0),H=x(()=>typeof d.errorMessage=="string"&&d.errorMessage.length!==0?d.errorMessage:g.value);z(()=>d.modelValue,()=>{h.value=!0,C.value===!0&&d.lazyRules===!1&&$()});function I(){d.lazyRules!=="ondemand"&&C.value===!0&&h.value===!0&&$()}z(()=>d.reactiveRules,j=>{j===!0?F===void 0&&(F=z(()=>d.rules,I,{immediate:!0,deep:!0})):F!==void 0&&(F(),F=void 0)},{immediate:!0}),z(()=>d.lazyRules,I),z(e,j=>{j===!0?h.value=!0:C.value===!0&&d.lazyRules!=="ondemand"&&$()});function O(){w++,r.value=!1,h.value=!1,m.value=!1,g.value=null,$.cancel()}function U(j=d.modelValue){if(d.disable===!0||E.value===!1)return!0;const V=++w,Q=r.value!==!0?()=>{h.value=!0}:()=>{},N=(S,a)=>{S===!0&&Q(),m.value=S,g.value=a||null,r.value=!1},D=[];for(let S=0;S<d.rules.length;S++){const a=d.rules[S];let l;if(typeof a=="function"?l=a(j,le):typeof a=="string"&&le[a]!==void 0&&(l=le[a](j)),l===!1||typeof l=="string")return N(!0,l),!1;l!==!0&&l!==void 0&&D.push(l)}return D.length===0?(N(!1),!0):(r.value=!0,Promise.all(D).then(S=>{if(S===void 0||Array.isArray(S)===!1||S.length===0)return V===w&&N(!1),!0;const a=S.find(l=>l===!1||typeof l=="string");return V===w&&N(a!==void 0,a),a===void 0},S=>(V===w&&(console.error(S),N(!0)),!1)))}const $=je(U,0);return ae(()=>{F!==void 0&&F(),$.cancel()}),Object.assign(s,{resetValidation:O,validate:U}),ye(s,"hasError",()=>k.value),{isDirtyModel:h,hasRules:E,hasError:k,errorMessage:H,validate:U,resetValidation:O}}let ie=[],Ze=[];function ke(e){Ze.length===0?e():ie.push(e)}function He(e){ie=ie.filter(r=>r!==e)}function ue(e){return e!=null&&(""+e).length!==0}const Qe={...Be,...ze,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},We={...Qe,maxlength:[Number,String]},Ye=["update:modelValue","clear","focus","blur"];function Ge({requiredForAttr:e=!0,tagProp:r,changeEvent:d=!1}={}){const{props:s,proxy:m}=G(),g=Ae(s,m.$q),h=Pe({required:e,getValue:()=>s.for});return{requiredForAttr:e,changeEvent:d,tag:r===!0?x(()=>s.tag):{value:"label"},isDark:g,editable:x(()=>s.disable!==!0&&s.readonly!==!0),innerLoading:T(!1),focused:T(!1),hasPopupOpen:!1,splitAttrs:De(),targetUid:h,rootRef:T(null),targetRef:T(null),controlRef:T(null)}}function Je(e){const{props:r,emit:d,slots:s,attrs:m,proxy:g}=G(),{$q:h}=g;let w=null;e.hasValue===void 0&&(e.hasValue=x(()=>ue(r.modelValue))),e.emitValue===void 0&&(e.emitValue=c=>{d("update:modelValue",c)}),e.controlEvents===void 0&&(e.controlEvents={onFocusin:t,onFocusout:o}),Object.assign(e,{clearValue:u,onControlFocusin:t,onControlFocusout:o,focus:a}),e.computedCounter===void 0&&(e.computedCounter=x(()=>{if(r.counter!==!1){const c=typeof r.modelValue=="string"||typeof r.modelValue=="number"?(""+r.modelValue).length:Array.isArray(r.modelValue)===!0?r.modelValue.length:0,y=r.maxlength!==void 0?r.maxlength:r.maxValues;return c+(y!==void 0?" / "+y:"")}}));const{isDirtyModel:F,hasRules:E,hasError:C,errorMessage:k,resetValidation:H}=Ke(e.focused,e.innerLoading),I=e.floatingLabel!==void 0?x(()=>r.stackLabel===!0||e.focused.value===!0||e.floatingLabel.value===!0):x(()=>r.stackLabel===!0||e.focused.value===!0||e.hasValue.value===!0),O=x(()=>r.bottomSlots===!0||r.hint!==void 0||E.value===!0||r.counter===!0||r.error!==null),U=x(()=>r.filled===!0?"filled":r.outlined===!0?"outlined":r.borderless===!0?"borderless":r.standout?"standout":"standard"),$=x(()=>`q-field row no-wrap items-start q-field--${U.value}`+(e.fieldClass!==void 0?` ${e.fieldClass.value}`:"")+(r.rounded===!0?" q-field--rounded":"")+(r.square===!0?" q-field--square":"")+(I.value===!0?" q-field--float":"")+(V.value===!0?" q-field--labeled":"")+(r.dense===!0?" q-field--dense":"")+(r.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(e.isDark.value===!0?" q-field--dark":"")+(e.getControl===void 0?" q-field--auto-height":"")+(e.focused.value===!0?" q-field--focused":"")+(C.value===!0?" q-field--error":"")+(C.value===!0||e.focused.value===!0?" q-field--highlighted":"")+(r.hideBottomSpace!==!0&&O.value===!0?" q-field--with-bottom":"")+(r.disable===!0?" q-field--disabled":r.readonly===!0?" q-field--readonly":"")),j=x(()=>"q-field__control relative-position row no-wrap"+(r.bgColor!==void 0?` bg-${r.bgColor}`:"")+(C.value===!0?" text-negative":typeof r.standout=="string"&&r.standout.length!==0&&e.focused.value===!0?` ${r.standout}`:r.color!==void 0?` text-${r.color}`:"")),V=x(()=>r.labelSlot===!0||r.label!==void 0),Q=x(()=>"q-field__label no-pointer-events absolute ellipsis"+(r.labelColor!==void 0&&C.value!==!0?` text-${r.labelColor}`:"")),N=x(()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:I.value,modelValue:r.modelValue,emitValue:e.emitValue})),D=x(()=>{const c={};return e.targetUid.value&&(c.for=e.targetUid.value),r.disable===!0&&(c["aria-disabled"]="true"),c});function S(){const c=document.activeElement;let y=e.targetRef!==void 0&&e.targetRef.value;y&&(c===null||c.id!==e.targetUid.value)&&(y.hasAttribute("tabindex")===!0||(y=y.querySelector("[tabindex]")),y&&y!==c&&y.focus({preventScroll:!0}))}function a(){ke(S)}function l(){He(S);const c=document.activeElement;c!==null&&e.rootRef.value.contains(c)&&c.blur()}function t(c){w!==null&&(clearTimeout(w),w=null),e.editable.value===!0&&e.focused.value===!1&&(e.focused.value=!0,d("focus",c))}function o(c,y){w!==null&&clearTimeout(w),w=setTimeout(()=>{w=null,!(document.hasFocus()===!0&&(e.hasPopupOpen===!0||e.controlRef===void 0||e.controlRef.value===null||e.controlRef.value.contains(document.activeElement)!==!1))&&(e.focused.value===!0&&(e.focused.value=!1,d("blur",c)),y!==void 0&&y())})}function u(c){qe(c),h.platform.is.mobile!==!0?(e.targetRef!==void 0&&e.targetRef.value||e.rootRef.value).focus():e.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),r.type==="file"&&(e.inputRef.value.value=null),d("update:modelValue",null),e.changeEvent===!0&&d("change",null),d("clear",r.modelValue),Y(()=>{const y=F.value;H(),F.value=y})}function n(c){[13,32].includes(c.keyCode)&&u(c)}function f(){const c=[];return s.prepend!==void 0&&c.push(M("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:ee},s.prepend())),c.push(M("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},v())),C.value===!0&&r.noErrorIcon===!1&&c.push(p("error",[M(de,{name:h.iconSet.field.error,color:"negative"})])),r.loading===!0||e.innerLoading.value===!0?c.push(p("inner-loading-append",s.loading!==void 0?s.loading():[M(Re,{color:r.color})])):r.clearable===!0&&e.hasValue.value===!0&&e.editable.value===!0&&c.push(p("inner-clearable-append",[M(de,{class:"q-field__focusable-action",name:r.clearIcon||h.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":h.lang.label.clear,onKeyup:n,onClick:u})])),s.append!==void 0&&c.push(M("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:ee},s.append())),e.getInnerAppend!==void 0&&c.push(p("inner-append",e.getInnerAppend())),e.getControlChild!==void 0&&c.push(e.getControlChild()),c}function v(){const c=[];return r.prefix!==void 0&&r.prefix!==null&&c.push(M("div",{class:"q-field__prefix no-pointer-events row items-center"},r.prefix)),e.getShadowControl!==void 0&&e.hasShadow.value===!0&&c.push(e.getShadowControl()),e.getControl!==void 0?c.push(e.getControl()):s.rawControl!==void 0?c.push(s.rawControl()):s.control!==void 0&&c.push(M("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":r.autofocus===!0||void 0},s.control(N.value))),V.value===!0&&c.push(M("div",{class:Q.value},te(s.label,r.label))),r.suffix!==void 0&&r.suffix!==null&&c.push(M("div",{class:"q-field__suffix no-pointer-events row items-center"},r.suffix)),c.concat(te(s.default))}function q(){let c,y;C.value===!0?k.value!==null?(c=[M("div",{role:"alert"},k.value)],y=`q--slot-error-${k.value}`):(c=te(s.error),y="q--slot-error"):(r.hideHint!==!0||e.focused.value===!0)&&(r.hint!==void 0?(c=[M("div",r.hint)],y=`q--slot-hint-${r.hint}`):(c=te(s.hint),y="q--slot-hint"));const _=r.counter===!0||s.counter!==void 0;if(r.hideBottomSpace===!0&&_===!1&&c===void 0)return;const A=M("div",{key:y,class:"q-field__messages col"},c);return M("div",{class:"q-field__bottom row items-start q-field__bottom--"+(r.hideBottomSpace!==!0?"animated":"stale"),onClick:ee},[r.hideBottomSpace===!0?A:M(Se,{name:"q-transition--field-message"},()=>A),_===!0?M("div",{class:"q-field__counter"},s.counter!==void 0?s.counter():e.computedCounter.value):null])}function p(c,y){return y===null?null:M("div",{key:c,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},y)}let b=!1;return Me(()=>{b=!0}),Ee(()=>{b===!0&&r.autofocus===!0&&g.focus()}),r.autofocus===!0&&ce(()=>{g.focus()}),ae(()=>{w!==null&&clearTimeout(w)}),Object.assign(g,{focus:a,blur:l}),function(){const y=e.getControl===void 0&&s.control===void 0?{...e.splitAttrs.attributes.value,"data-autofocus":r.autofocus===!0||void 0,...D.value}:D.value;return M(e.tag.value,{ref:e.rootRef,class:[$.value,m.class],style:m.style,...y},[s.before!==void 0?M("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:ee},s.before()):null,M("div",{class:"q-field__inner relative-position col self-stretch"},[M("div",{ref:e.controlRef,class:j.value,tabindex:-1,...e.controlEvents},f()),O.value===!0?q():null]),s.after!==void 0?M("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:ee},s.after()):null])}}const pe={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},ne={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}},xe=Object.keys(ne);xe.forEach(e=>{ne[e].regex=new RegExp(ne[e].pattern)});const Xe=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+xe.join("")+"])|(.)","g"),be=/[.*+?^${}()|[\]\\]/g,B="",et={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function tt(e,r,d,s){let m,g,h,w,F,E;const C=T(null),k=T(I());function H(){return e.autogrow===!0||["textarea","text","search","url","tel","password"].includes(e.type)}z(()=>e.type+e.autogrow,U),z(()=>e.mask,t=>{if(t!==void 0)$(k.value,!0);else{const o=a(k.value);U(),e.modelValue!==o&&r("update:modelValue",o)}}),z(()=>e.fillMask+e.reverseFillMask,()=>{C.value===!0&&$(k.value,!0)}),z(()=>e.unmaskedValue,()=>{C.value===!0&&$(k.value)});function I(){if(U(),C.value===!0){const t=D(a(e.modelValue));return e.fillMask!==!1?l(t):t}return e.modelValue}function O(t){if(t<m.length)return m.slice(-t);let o="",u=m;const n=u.indexOf(B);if(n!==-1){for(let f=t-u.length;f>0;f--)o+=B;u=u.slice(0,n)+o+u.slice(n)}return u}function U(){if(C.value=e.mask!==void 0&&e.mask.length!==0&&H(),C.value===!1){w=void 0,m="",g="";return}const t=pe[e.mask]===void 0?e.mask:pe[e.mask],o=typeof e.fillMask=="string"&&e.fillMask.length!==0?e.fillMask.slice(0,1):"_",u=o.replace(be,"\\$&"),n=[],f=[],v=[];let q=e.reverseFillMask===!0,p="",b="";t.replace(Xe,(A,i,P,W,Z)=>{if(W!==void 0){const L=ne[W];v.push(L),b=L.negate,q===!0&&(f.push("(?:"+b+"+)?("+L.pattern+"+)?(?:"+b+"+)?("+L.pattern+"+)?"),q=!1),f.push("(?:"+b+"+)?("+L.pattern+")?")}else if(P!==void 0)p="\\"+(P==="\\"?"":P),v.push(P),n.push("([^"+p+"]+)?"+p+"?");else{const L=i!==void 0?i:Z;p=L==="\\"?"\\\\\\\\":L.replace(be,"\\\\$&"),v.push(L),n.push("([^"+p+"]+)?"+p+"?")}});const c=new RegExp("^"+n.join("")+"("+(p===""?".":"[^"+p+"]")+"+)?"+(p===""?"":"["+p+"]*")+"$"),y=f.length-1,_=f.map((A,i)=>i===0&&e.reverseFillMask===!0?new RegExp("^"+u+"*"+A):i===y?new RegExp("^"+A+"("+(b===""?".":b)+"+)?"+(e.reverseFillMask===!0?"$":u+"*")):new RegExp("^"+A));h=v,w=A=>{const i=c.exec(e.reverseFillMask===!0?A:A.slice(0,v.length+1));i!==null&&(A=i.slice(1).join(""));const P=[],W=_.length;for(let Z=0,L=A;Z<W;Z++){const J=_[Z].exec(L);if(J===null)break;L=L.slice(J.shift().length),P.push(...J)}return P.length!==0?P.join(""):A},m=v.map(A=>typeof A=="string"?A:B).join(""),g=m.split(B).join(o)}function $(t,o,u){const n=s.value,f=n.selectionEnd,v=n.value.length-f,q=a(t);o===!0&&U();const p=D(q),b=e.fillMask!==!1?l(p):p,c=k.value!==b;n.value!==b&&(n.value=b),c===!0&&(k.value=b),document.activeElement===n&&Y(()=>{if(b===g){const _=e.reverseFillMask===!0?g.length:0;n.setSelectionRange(_,_,"forward");return}if(u==="insertFromPaste"&&e.reverseFillMask!==!0){const _=n.selectionEnd;let A=f-1;for(let i=F;i<=A&&i<_;i++)m[i]!==B&&A++;V.right(n,A);return}if(["deleteContentBackward","deleteContentForward"].indexOf(u)!==-1){const _=e.reverseFillMask===!0?f===0?b.length>p.length?1:0:Math.max(0,b.length-(b===g?0:Math.min(p.length,v)+1))+1:f;n.setSelectionRange(_,_,"forward");return}if(e.reverseFillMask===!0)if(c===!0){const _=Math.max(0,b.length-(b===g?0:Math.min(p.length,v+1)));_===1&&f===1?n.setSelectionRange(_,_,"forward"):V.rightReverse(n,_)}else{const _=b.length-v;n.setSelectionRange(_,_,"backward")}else if(c===!0){const _=Math.max(0,m.indexOf(B),Math.min(p.length,f)-1);V.right(n,_)}else{const _=f-1;V.right(n,_)}});const y=e.unmaskedValue===!0?a(b):b;String(e.modelValue)!==y&&(e.modelValue!==null||y!=="")&&d(y,!0)}function j(t,o,u){const n=D(a(t.value));o=Math.max(0,m.indexOf(B),Math.min(n.length,o)),F=o,t.setSelectionRange(o,u,"forward")}const V={left(t,o){const u=m.slice(o-1).indexOf(B)===-1;let n=Math.max(0,o-1);for(;n>=0;n--)if(m[n]===B){o=n,u===!0&&o++;break}if(n<0&&m[o]!==void 0&&m[o]!==B)return V.right(t,0);o>=0&&t.setSelectionRange(o,o,"backward")},right(t,o){const u=t.value.length;let n=Math.min(u,o+1);for(;n<=u;n++)if(m[n]===B){o=n;break}else m[n-1]===B&&(o=n);if(n>u&&m[o-1]!==void 0&&m[o-1]!==B)return V.left(t,u);t.setSelectionRange(o,o,"forward")},leftReverse(t,o){const u=O(t.value.length);let n=Math.max(0,o-1);for(;n>=0;n--)if(u[n-1]===B){o=n;break}else if(u[n]===B&&(o=n,n===0))break;if(n<0&&u[o]!==void 0&&u[o]!==B)return V.rightReverse(t,0);o>=0&&t.setSelectionRange(o,o,"backward")},rightReverse(t,o){const u=t.value.length,n=O(u),f=n.slice(0,o+1).indexOf(B)===-1;let v=Math.min(u,o+1);for(;v<=u;v++)if(n[v-1]===B){o=v,o>0&&f===!0&&o--;break}if(v>u&&n[o-1]!==void 0&&n[o-1]!==B)return V.leftReverse(t,u);t.setSelectionRange(o,o,"forward")}};function Q(t){r("click",t),E=void 0}function N(t){if(r("keydown",t),Fe(t)===!0||t.altKey===!0)return;const o=s.value,u=o.selectionStart,n=o.selectionEnd;if(t.shiftKey||(E=void 0),t.keyCode===37||t.keyCode===39){t.shiftKey&&E===void 0&&(E=o.selectionDirection==="forward"?u:n);const f=V[(t.keyCode===39?"right":"left")+(e.reverseFillMask===!0?"Reverse":"")];if(t.preventDefault(),f(o,E===u?n:u),t.shiftKey){const v=o.selectionStart;o.setSelectionRange(Math.min(E,v),Math.max(E,v),"forward")}}else t.keyCode===8&&e.reverseFillMask!==!0&&u===n?(V.left(o,u),o.setSelectionRange(o.selectionStart,n,"backward")):t.keyCode===46&&e.reverseFillMask===!0&&u===n&&(V.rightReverse(o,n),o.setSelectionRange(u,o.selectionEnd,"forward"))}function D(t){if(t==null||t==="")return"";if(e.reverseFillMask===!0)return S(t);const o=h;let u=0,n="";for(let f=0;f<o.length;f++){const v=t[u],q=o[f];if(typeof q=="string")n+=q,v===q&&u++;else if(v!==void 0&&q.regex.test(v))n+=q.transform!==void 0?q.transform(v):v,u++;else return n}return n}function S(t){const o=h,u=m.indexOf(B);let n=t.length-1,f="";for(let v=o.length-1;v>=0&&n!==-1;v--){const q=o[v];let p=t[n];if(typeof q=="string")f=q+f,p===q&&n--;else if(p!==void 0&&q.regex.test(p))do f=(q.transform!==void 0?q.transform(p):p)+f,n--,p=t[n];while(u===v&&p!==void 0&&q.regex.test(p));else return f}return f}function a(t){return typeof t!="string"||w===void 0?typeof t=="number"?w(""+t):t:w(t)}function l(t){return g.length-t.length<=0?t:e.reverseFillMask===!0&&t.length!==0?g.slice(0,-t.length)+t:t+g.slice(t.length)}return{innerValue:k,hasMask:C,moveCursorForPaste:j,updateMaskValue:$,onMaskedKeydown:N,onMaskedClick:Q}}function rt(e,r){function d(){const s=e.modelValue;try{const m="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(s)===s&&("length"in s?Array.from(s):[s]).forEach(g=>{m.items.add(g)}),{files:m.files}}catch{return{files:void 0}}}return x(()=>{if(e.type==="file")return d()})}const ot=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,nt=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,at=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,lt=/[a-z0-9_ -]$/i;function st(e){return function(d){if(d.type==="compositionend"||d.type==="change"){if(d.target.qComposing!==!0)return;d.target.qComposing=!1,e(d)}else d.type==="compositionupdate"&&d.target.qComposing!==!0&&typeof d.data=="string"&&(Ie.is.firefox===!0?lt.test(d.data)===!1:ot.test(d.data)===!0||nt.test(d.data)===!0||at.test(d.data)===!0)===!0&&(d.target.qComposing=!0)}}const ft=we({name:"QInput",inheritAttrs:!1,props:{...We,...et,...$e,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ye,"paste","change","keydown","click","animationend"],setup(e,{emit:r,attrs:d}){const{proxy:s}=G(),{$q:m}=s,g={};let h=NaN,w,F,E=null,C;const k=T(null),H=Te(e),{innerValue:I,hasMask:O,moveCursorForPaste:U,updateMaskValue:$,onMaskedKeydown:j,onMaskedClick:V}=tt(e,r,p,k),Q=rt(e),N=x(()=>ue(I.value)),D=st(v),S=Ge({changeEvent:!0}),a=x(()=>e.type==="textarea"||e.autogrow===!0),l=x(()=>a.value===!0||["text","search","url","tel","password"].includes(e.type)),t=x(()=>{const i={...S.splitAttrs.listeners.value,onInput:v,onPaste:f,onChange:c,onBlur:y,onFocus:fe};return i.onCompositionstart=i.onCompositionupdate=i.onCompositionend=D,O.value===!0&&(i.onKeydown=j,i.onClick=V),e.autogrow===!0&&(i.onAnimationend=q),i}),o=x(()=>{const i={tabindex:0,"data-autofocus":e.autofocus===!0||void 0,rows:e.type==="textarea"?6:void 0,"aria-label":e.label,name:H.value,...S.splitAttrs.attributes.value,id:S.targetUid.value,maxlength:e.maxlength,disabled:e.disable===!0,readonly:e.readonly===!0};return a.value===!1&&(i.type=e.type),e.autogrow===!0&&(i.rows=1),i});z(()=>e.type,()=>{k.value&&(k.value.value=e.modelValue)}),z(()=>e.modelValue,i=>{if(O.value===!0){if(F===!0&&(F=!1,String(i)===h))return;$(i)}else I.value!==i&&(I.value=i,e.type==="number"&&g.hasOwnProperty("value")===!0&&(w===!0?w=!1:delete g.value));e.autogrow===!0&&Y(b)}),z(()=>e.autogrow,i=>{i===!0?Y(b):k.value!==null&&d.rows>0&&(k.value.style.height="auto")}),z(()=>e.dense,()=>{e.autogrow===!0&&Y(b)});function u(){ke(()=>{const i=document.activeElement;k.value!==null&&k.value!==i&&(i===null||i.id!==S.targetUid.value)&&k.value.focus({preventScroll:!0})})}function n(){k.value!==null&&k.value.select()}function f(i){if(O.value===!0&&e.reverseFillMask!==!0){const P=i.target;U(P,P.selectionStart,P.selectionEnd)}r("paste",i)}function v(i){if(!i||!i.target)return;if(e.type==="file"){r("update:modelValue",i.target.files);return}const P=i.target.value;if(i.target.qComposing===!0){g.value=P;return}if(O.value===!0)$(P,!1,i.inputType);else if(p(P),l.value===!0&&i.target===document.activeElement){const{selectionStart:W,selectionEnd:Z}=i.target;W!==void 0&&Z!==void 0&&Y(()=>{i.target===document.activeElement&&P.indexOf(i.target.value)===0&&i.target.setSelectionRange(W,Z)})}e.autogrow===!0&&b()}function q(i){r("animationend",i),b()}function p(i,P){C=()=>{E=null,e.type!=="number"&&g.hasOwnProperty("value")===!0&&delete g.value,e.modelValue!==i&&h!==i&&(h=i,P===!0&&(F=!0),r("update:modelValue",i),Y(()=>{h===i&&(h=NaN)})),C=void 0},e.type==="number"&&(w=!0,g.value=i),e.debounce!==void 0?(E!==null&&clearTimeout(E),g.value=i,E=setTimeout(C,e.debounce)):C()}function b(){requestAnimationFrame(()=>{const i=k.value;if(i!==null){const P=i.parentNode.style,{scrollTop:W}=i,{overflowY:Z,maxHeight:L}=m.platform.is.firefox===!0?{}:window.getComputedStyle(i),J=Z!==void 0&&Z!=="scroll";J===!0&&(i.style.overflowY="hidden"),P.marginBottom=i.scrollHeight-1+"px",i.style.height="1px",i.style.height=i.scrollHeight+"px",J===!0&&(i.style.overflowY=parseInt(L,10)<i.scrollHeight?"auto":"hidden"),P.marginBottom="",i.scrollTop=W}})}function c(i){D(i),E!==null&&(clearTimeout(E),E=null),C!==void 0&&C(),r("change",i.target.value)}function y(i){i!==void 0&&fe(i),E!==null&&(clearTimeout(E),E=null),C!==void 0&&C(),w=!1,F=!1,delete g.value,e.type!=="file"&&setTimeout(()=>{k.value!==null&&(k.value.value=I.value!==void 0?I.value:"")})}function _(){return g.hasOwnProperty("value")===!0?g.value:I.value!==void 0?I.value:""}ae(()=>{y()}),ce(()=>{e.autogrow===!0&&b()}),Object.assign(S,{innerValue:I,fieldClass:x(()=>`q-${a.value===!0?"textarea":"input"}`+(e.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:x(()=>e.type!=="file"&&typeof e.shadowText=="string"&&e.shadowText.length!==0),inputRef:k,emitValue:p,hasValue:N,floatingLabel:x(()=>N.value===!0&&(e.type!=="number"||isNaN(I.value)===!1)||ue(e.displayValue)),getControl:()=>M(a.value===!0?"textarea":"input",{ref:k,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...o.value,...t.value,...e.type!=="file"?{value:_()}:Q.value}),getShadowControl:()=>M("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(a.value===!0?"":" text-no-wrap")},[M("span",{class:"invisible"},_()),M("span",e.shadowText)])});const A=Je(S);return Object.assign(s,{focus:u,select:n,getNativeElement:()=>k.value}),ye(s,"nativeEl",()=>k.value),A}}),gt=we({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:r}){const{proxy:{$q:d}}=G(),s=se(Oe,X);if(s===X)return console.error("QPage needs to be a deep child of QLayout"),X;if(se(Ue,X)===X)return console.error("QPage needs to be child of QPageContainer"),X;const g=x(()=>{const w=(s.header.space===!0?s.header.size:0)+(s.footer.space===!0?s.footer.size:0);if(typeof e.styleFn=="function"){const F=s.isContainer.value===!0?s.containerHeight.value:d.screen.height;return e.styleFn(w,F)}return{minHeight:s.isContainer.value===!0?s.containerHeight.value-w+"px":d.screen.height===0?w!==0?`calc(100vh - ${w}px)`:"100vh":d.screen.height-w+"px"}}),h=x(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>M("main",{class:h.value,style:g.value},te(r.default))}}),it=e=>{if(!e)return"";const r={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,r)};let K=null;const Ce=async()=>{if(console.log("Fetching user..."),K)return console.log("User already fetched"),K;const{data:{user:e},error:r}=await R.auth.getUser();return r?(console.error("Error fetching user:",r),null):(K=e,console.log("Returning user..."),K)};Ce();const mt=()=>{const e=T([]),r=T(!1),d=T(!1),s=T(null),m=async a=>{try{const{data:l}=await R.from("blog_posts").select("likes").eq("id",a).single(),t=(l==null?void 0:l.likes)||0,{data:o,error:u}=await R.from("blog_posts").update({likes:t+1}).eq("id",a).select("likes").single();if(u)throw u;const n=e.value.findIndex(f=>f.id===a);return n!==-1&&(e.value[n]={...e.value[n],likes:o.likes}),o}catch(l){console.error("Error liking post:",l),s.value=l.message}},g=async a=>{try{const{data:l,error:t}=await R.from("blog_posts").select("*").eq("id",a).single();if(t)throw t;return l}catch(l){return console.error("Error fetching post:",l),s.value=l.message,null}},h=async a=>{console.log("Deleting post for iD: ",a);const l=await g(a);if(!l)return;const t=l.image_url;console.log("Checking if other posts use the same image");const{data:o,error:u}=await R.from("blog_posts").select("image_url").eq("image_url",t).neq("id",a);if(u){console.error("Error checking image usage:",u);return}if(console.log("Number of other posts using the same image: ",o.length),o.length===0&&t){console.log("No other posts use the same image so deleting it...");const{error:f}=await R.storage.from("images/public").remove([t]);f&&console.error("Error deleting image:",f)}const{error:n}=await R.from("blog_posts").delete().eq("id",a);if(n){console.error("Error deleting post:",n);return}e.value=e.value.filter(f=>f.id!==a)},w=async(a,l,t,o,u,n,f,v,q,p)=>{console.log("Creating post with title: "+a),console.log("content "+l),console.log("category "+u),console.log("author "+n),console.log("language "+v),console.log("linkedPostID :"+f),console.log("translationAvailable "+q),console.log("translatedLanguage "+p);try{const{data:b,error:c}=await R.from("blog_posts").insert([{title:a,content:l,image_url:t||"",styles:o,likes:0,category:u,author:n,language:v,linked_post_id:f,translation_available:!!q,translation_language:p||"japanese"}]).select().single();if(c)throw c;return e.value.unshift(b),b}catch(b){return console.error("Error creating post:",b),s.value=b.message,null}},F=async a=>{try{const{data:l,error:t}=await R.from("blog_posts").select("linked_post_id").eq("id",a).single();if(t)throw t;return l.linked_post_id}catch(l){return console.error("Error fetching translated post ID:",l),s.value=l.message,null}},E=async()=>{try{r.value=!0;const{data:a,error:l}=await R.from("blog_posts").select("*").order("created_at",{ascending:!1});if(l)throw l;return e.value=a,a}catch(a){return console.error("Error fetching posts:",a),s.value=a.message,null}finally{r.value=!1}},C=async(a,l,t,o)=>{if(console.log("Updating linked post with postId: "+a),console.log("linkedPostID: "+l),console.log("translation_language: "+t),console.log("translation_available: "+o),!l)return console.error("Error updating linked post. No post ID provided"),s.value=err.message,null;try{const{data:u,error:n}=await R.from("blog_posts").update({linked_post_id:l,translation_language:t,translation_available:o}).eq("id",a).select().single();if(n)throw n;const f=e.value.findIndex(v=>v.id===a);return f!==-1&&(e.value[f]=u),console.log("Returning new post data"),u}catch(u){return console.error("Error updating linked post:",u),s.value=u.message,null}},k=async(a,l,t,o)=>{console.log("Updating post with title: "+l),console.log("postId: "+a),console.log("category: "+t),console.log("content: "+o);try{const{data:u,error:n}=await R.from("blog_posts").update({title:l,category:t,content:o}).eq("id",a).select().single();if(n)throw n;const f=e.value.findIndex(v=>v.id===a);return f!==-1&&(e.value[f]=u),u}catch(u){return console.error("Error updating post:",u),s.value=u.message,null}},H=async(a,l,t)=>{try{const{data:o,error:u}=await R.from("blog_posts").insert([{title:`Translated Post of ${a}`,content:l,linked_post_id:a,translation_language:t,translation_available:!0}]).select().single();if(u)throw u;return o}catch(o){return console.error("Error publishing translated post:",o),s.value=o.message,null}},I=async a=>{const{data:l,error:t}=await R.storage.from("images").update(`${a.name}`,a,{cacheControl:"3600",upsert:!0});return t&&(s.value=t.message),l.path},O=async(a,l=!0)=>{const{data:t,error:o}=await R.storage.from("images/public").upload(a.name,a);if(o){if(console.error("Error uploading image:",o),o.error==="Duplicate"){if(console.log("Duplicate image - will use existing: "+l),l)return a.name;o.value="Image already exists"}return null}return t.path},U=async a=>{try{const{data:l,error:t}=await R.storage.from("images/public/").download(a);if(t)throw t;return URL.createObjectURL(l)}catch(l){return console.error("Error downloading image:",l),console.log("Problem with image path:",a),s.value=l.message,null}},$=async a=>{if(!a.id){s.value="Pass a user ID to update the profile";return}try{r.value=!0;let{error:l}=await R.from("profiles").upsert(a);if(l)throw l}catch(l){l.value=l.message}finally{r.value=!1}},j=async(a,l,t)=>{console.log("addComment content: "+l),console.log("addComment username: "+t);const o="5e02ab47-4fd4-4620-8ce0-e6b73021b8f9";if(console.log("guestUserID: "+o),!a)throw"No postId provided";if(!l)throw"No content provided";let u=o,n=!1;K&&(u=K.id,n=!0);try{const{data:f,error:v}=await R.from("comments").insert([{post_id:a,user_id:u,content:l,username:t,approved:n}]).select().single();if(v)throw v;return f}catch(f){return console.error("Error adding comment:",f),s.value=f.message,null}},V=async a=>{try{d.value=!0;const{data:l,error:t}=await R.from("comments").select("*").eq("post_id",a).eq("approved",!0).order("created_at",{ascending:!0});if(t)throw t;return l}catch(l){return console.error("Error fetching comments:",l),s.value=l.message,[]}finally{d.value=!1}},Q=async a=>{try{const{data:l,error:t}=await R.storage.from("avatars").download(a);if(t)throw t;return URL.createObjectURL(l)}catch(l){return console.error("Error downloading avatar: ",l.message),null}},N=async()=>{if(!K){console.log("getSignedInUserProfile no user...");const t=await Ce();if(!t||!t.id)return null;K=t}let{data:a,error:l}=await R.from("profiles").select("username, website, avatar_url").eq("id",K.id).single();return l?(l.value=l.message,null):a};async function D(){try{r.value=!0;let{error:a}=await R.auth.signOut();return!0}catch(a){return a.value=a.message,!1}finally{r.value=!1}}return{posts:e,loading:r,commentsLoading:d,error:s,user:K,updateLinkedPost:C,signInWithEmailAndPassword:async(a,l)=>{const{data:t,error:o}=await R.auth.signInWithPassword({email:a,password:l});return o?(console.error("Error signing in: ",o.message),!1):!0},uploadImage:O,uploadReplaceImage:I,downloadImage:U,fetchPosts:E,getPost:g,createPost:w,updatePost:k,publishTranslatedPost:H,getTranslatedPostId:F,addComment:j,getComments:V,likePost:m,signOut:D,formatDate:it,getSignedInUserProfile:N,isUserSignedIn:()=>K!==null,getSignedInUser:()=>K,downloadUserAvatar:Q,updateUserProfile:$,deletePost:h}};export{ft as Q,gt as a,ke as b,mt as u};
